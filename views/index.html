<!DOCTYPE html>
<html>
<head>
  <title>M-Tracer Golf Swing Dashboard</title>
  <link rel="stylesheet" href="/css/style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>
<body>
  <!-- 🔥 ロゴ付きヘッダー -->
  <div class="header">
    <div class="logo-line">
      <div class="logo-area">
        <img src="/images/logo.png" alt="M-Tracer Logo" class="logo-img">
        <div class="logo-text">
          <div class="logo-title">M-tracer AI  Swing Data Dashboard</div>
          <div class="logo-subtitle">Golf Swing 3D Motion Sensor M-Tracer by Epson</div>
        </div>
      </div>
      <div class="last-updated">Last updated: Apr 4, 2025</div>
    </div>
  </div>

  <!-- ユーザーステータス -->
  <div class="user-stats">
    M-Tracer アクティブユーザーの傾向値 (2025/4月 / 指標中央値) 732,761 swing data
  </div>

  <!-- メインメトリクス -->
  <div class="metric-row">
    <div class="card metric-card">
      <div class="metric-label">Estimate CARRY</div>
<div class="metric" id="median-estimateCarry" data-type="estimateCarry">--</div>
    </div>
    <div class="card metric-card">
      <div class="metric-label">HEAD SPEED</div>
<div class="metric" id="median-impactHeadSpeed" data-type="impactHeadSpeed">--</div>
    </div>
    <div class="card metric-card">
      <div class="metric-label">FACE ANGLE</div>
<div class="metric" id="median-impactFaceAngle" data-type="impactFaceAngle">--</div>
    </div>
  </div>


    <!-- サブメトリクス -->
    <div class="section-title">指標ごとの傾向値 (2025/4月 / 指標中央値)</div>
    
    <div class="detailed-metrics metrics-row">

<div class="card metric-card">
  <div class="metric-label">CLUB PATH</div>
  <div class="metric" data-type="impactClubPath">--</div>
</div>

<div class="card metric-card">
  <div class="metric-label">LOFT ANGLE</div>
  <div class="metric" data-type="impactLoftAngle">--</div>
</div>

<div class="card metric-card">
  <div class="metric-label">GRIP SPEED</div>
  <div class="metric" data-type="maxGripSpeed">--</div>
</div>

<div class="card metric-card">
  <div class="metric-label">LIE ANGLE</div>
  <div class="metric" data-type="impactLieAngle">--</div>
</div>

<div class="card metric-card">
  <div class="metric-label">ATTACK ANGLE</div>
  <div class="metric" data-type="impactAttackAngle">--</div>
</div>

</div>


    </div>

<!-- データテーブル -->
<div class="table-section">
  <div class="section-title">スイングデータ一覧</div>
  <div class="table-container">
    <table class="data-table">
      <thead>
        <tr>
          <th class="sortable">id</th>
          <th class="sortable">impactHeadS...</th>
          <th class="sortable">impactClub...</th>
          <th class="sortable">impactFaceAn...</th>
          <th class="sortable">impactAttackAngle</th>
          <th class="sortable">estimateCarry</th>
        </tr>
      </thead>
      <tbody id="data-table-body">
        <tr>
          <td>1</td>
          <td>30.732466</td>
          <td>-4.9308873</td>
          <td>-3.734564</td>
          <td>4.5477686</td>
          <td>124.26448</td>
        </tr>
        <!-- その他の行は自動生成 -->
      </tbody>
    </table>
  </div>
  <div class="pagination" id="pagination"></div>
</div>

<!-- スイングタイプ選択エリア -->
<div class="swing-type-section">
  <div class="section-title">M-Tracerクラスタ分析（k-Means / SHAPデータ強化 / LightGBMモデル学習）によるスイングタイプ分類</div>
  
  <!-- スイングタイプ選択ドロップダウン -->
  <div class="swing-type-selector">
    <select id="swing-type-select" class="swing-type-dropdown">
      <option value="0">Swing type ID 0：アウトイン・パワーフォーム型</option>
      <option value="1">cSwing type ID 1：アウトイン・コンパクトフォーム型</option>
      <option value="2" selected>Swing type ID 2：インアウト・フレキシブルフォーム型</option>
      <option value="3">Swing type ID 3：インアウト・パワーフォーム型</option>
      <option value="4">Swing type ID 4：インアウト・スタンダードフォーム型</option>
      <option value="5">Swing type ID 5：アウトイン・スタンダードフォーム型</option>
      <option value="6">Swing type ID 6：スクエア・パワーフォーム型</option>
      <option value="7">Swing type ID 7：スクエア・コンパクトフォーム型</option>
      <option value="8">Swing type ID 8：ストレート・パワーフォーム型</option>
      <option value="9">Swing type ID 9：ストレート・コンパクトフォーム型</option>
    </select>
  </div>
  
  <!-- スイングタイプ情報表示エリア -->
  <div class="swing-type-info-container">
    <!-- スイング基本情報 -->
    <div class="swing-info-row">
      <div class="swing-info-box">
        <div class="info-label">SWING TYPE</div>
        <div id="swing-type-name" class="info-value">Flexible Inside-Out</div>
      </div>
      <div class="swing-info-box">
        <div class="info-label">CLUB TYPE</div>
        <div id="club-type" class="info-value">ドライバー</div>
      </div>
      <div class="swing-info-box swing-info-box-wide">
        <div class="info-label">CLUSTER NAME ID</div>
        <div id="cluster-name-jp" class="info-value">インアウト・フレキシブルフォーム型</div>
      </div>
    </div>
    
    <!-- スイング概要 -->
    <div class="swing-description" id="swing-overview">
      柔軟なフォームでスイング軌道に変化があり、状況対応力が高いスタイル。
    </div>
    
    <!-- スイングタイプごとの指標中央値 -->
    <div class="sub-section-title">スイングタイプによる指標中央値</div>
    
    <div class="metrics-row">
      <div class="metric-box">
        <div class="metric-label">ESTIMATE CARRY</div>
        <div id="type-estimateCarry" class="metric-value">206.0587</div>
      </div>
      
      <div class="metric-box">
        <div class="metric-label">HEAD SPEED</div>
        <div id="type-impactHeadSpeed" class="metric-value">38.87136</div>
      </div>
      
      <div class="metric-box">
        <div class="metric-label">FACE ANGLE</div>
        <div id="type-impactFaceAngle" class="metric-value">8.290537</div>
      </div>
      
      <div class="metric-box">
        <div class="metric-label">CLUB PATH</div>
        <div id="type-impactClubPath" class="metric-value">9.052126</div>
      </div>
      
      <div class="metric-box">
        <div class="metric-label">ATTACK ANGLE</div>
        <div id="type-impactAttackAngle" class="metric-value">-0.05148</div>
      </div>
    </div>
  </div>
</div>    
    <!-- モデルデータセクション -->
    <div class="section-title">M-Tracerの成功スイングモデル</div>
    
    <div class="model-ranges">
      <div>impactFaceAngle -5°～+5°　impactRelativeFaceAngle -5°～+5°</div>
      <div>estimateCarry ドライバー：180～270　アイアン：60～180</div>
      <div>impactAttackAngle ドライバー：0～+5（アッパーブロー）　アイアン：-7～-1（ダウンブロー）</div>
    </div>
    
    <div class="model-metrics">
      <div class="metric-box">
        <div class="label">impactClubPath</div>
        <div class="value">0.66</div>
      </div>
      
      <div class="metric-box">
        <div class="label">impactRelativeFaceAngle</div>
        <div class="value">0.46</div>
      </div>
      
      <div class="metric-box">
        <div class="label">halfwaybackFaceAngleVertical</div>
        <div class="value">-27.3</div>
      </div>
      
      <div class="metric-box">
        <div class="label">topFaceAngleHorizontal</div>
        <div class="value">7.1</div>
      </div>
      
      <div class="metric-box">
        <div class="label">downSwingShaftRotationMax</div>
        <div class="value">-422.4</div>
      </div>
      
      <div class="metric-box">
        <div class="label">impactShaftRotation</div>
        <div class="value">-1,236.5</div>
      </div>
    </div>

    <!-- ボタン類 -->
    <div class="section-divider">
    </div>
  </div>

  <!-- JS読込＆fetch処理 -->
  <script src="/js/dashboard.js"></script>
  <script>
    // APIから中央値を取得して画面に表示
    fetch('/api/median')
      .then(res => res.json())
      .then(data => {
        document.getElementById('median-estimateCarry').textContent =
          data.median_estimateCarry?.toFixed(1) ?? '--';+ 'yd'
        document.getElementById('median-impactHeadSpeed').textContent =
          (data.median_impactHeadSpeed?.toFixed(1) ?? '--') + 'm/s';
        document.getElementById('median-impactFaceAngle').textContent =
          (data.median_impactFaceAngle?.toFixed(1) ?? '--') + '°';
      })
      .catch(err => console.error('中央値取得エラー:', err));

  // この行を削除
  // fetchAndDisplayData();
  </script>
</script>

